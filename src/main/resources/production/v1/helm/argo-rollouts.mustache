controller:
  replicas: 2

  serviceAccount:
    create: true
    name: argo-rollouts-controller

  metrics:
    enabled: true
    serviceMonitor:
      enabled: false

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

  pdb:
    enabled: true
    minAvailable: 1

  containerSecurityContext:
    runAsNonRoot: true
    readOnlyRootFilesystem: true
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL

  extraArgs:
    - --leader-elect

dashboard:
  enabled: true
  replicas: 2

  serviceAccount:
    create: true
    name: argo-rollouts-dashboard

  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

  pdb:
    enabled: true
    minAvailable: 1

  containerSecurityContext:
    runAsNonRoot: true
    readOnlyRootFilesystem: true
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL

  ingress:
    enabled: false

installCRDs: true
keepCRDs: true

notifications:
  enabled: false

extraObjects:
  - apiVersion: v1
    kind: Secret
    metadata:
      name: argo-rollouts-alb-oidc
      namespace: argo-rollouts
      labels:
        app.kubernetes.io/part-of: argo-rollouts
    type: Opaque
    stringData:
      clientId: argo-rollouts
      clientSecret: "{{argoRollouts.ssoClientSecret}}"
  - apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      name: alb-controller-secrets-reader
      namespace: argo-rollouts
      labels:
        app.kubernetes.io/part-of: argo-rollouts
    rules:
      - apiGroups: [""]
        resources: ["secrets"]
        verbs: ["get"]
  - apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      name: alb-controller-secrets-reader
      namespace: argo-rollouts
      labels:
        app.kubernetes.io/part-of: argo-rollouts
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: alb-controller-secrets-reader
    subjects:
      - kind: ServiceAccount
        name: aws-load-balancer-controller
        namespace: aws-load-balancer
